# ドキュメントの修正設計書

## 1. 概要

### 1.1 設計の目的
要件定義書に基づき、プロジェクト内のドキュメントからSQLite関連の記述を削除し、必要に応じてPostgreSQL関連の記述を追加するための詳細設計を定義する。ドキュメントの整合性を保ち、開発者が誤解しないようにする。

### 1.2 設計の範囲
- `README.md` の確認と修正
- `docs/` ディレクトリ内のすべてのMarkdownファイルの確認と修正
- プロジェクトルート直下のMarkdownファイルの確認と修正
- SQLite関連記述の削除
- PostgreSQL関連記述の追加（必要に応じて）

### 1.3 設計方針
- **網羅的な確認**: すべてのドキュメントファイルを確認し、SQLite関連の記述を検索
- **段階的な修正**: 検索 → 確認 → 削除 → 追加の順序で作業を進める
- **整合性の確保**: ドキュメント間で記述が一貫していることを確認
- **既存記述の維持**: PostgreSQL/MySQLに関する既存の記述は維持する
- **履歴の保持**: `.kiro/specs/` 内の過去のspecファイルは履歴として残す

## 2. 作業手順設計

### 2.1 全体フロー

```
┌─────────────────────────────────────────────────────────────┐
│                   ドキュメント修正フロー                      │
└─────────────────────────────────────────────────────────────┘
                          │
                          ▼
        ┌─────────────────────────────────┐
        │ 1. 対象ファイルのリストアップ      │
        │    - README.md                   │
        │    - docs/*.md                  │
        │    - その他のMarkdownファイル     │
        └─────────────────────────────────┘
                          │
                          ▼
        ┌─────────────────────────────────┐
        │ 2. SQLite関連記述の検索           │
        │    - grepでSQLite/sqlite検索     │
        │    - 各ファイルを確認             │
        └─────────────────────────────────┘
                          │
                          ▼
        ┌─────────────────────────────────┐
        │ 3. SQLite関連記述の削除          │
        │    - 説明文の削除                │
        │    - 設定例の削除                │
        │    - 注意書きの削除              │
        │    - 比較表の行の削除            │
        └─────────────────────────────────┘
                          │
                          ▼
        ┌─────────────────────────────────┐
        │ 4. PostgreSQL関連記述の追加      │
        │    - 削除箇所の確認              │
        │    - PostgreSQL情報の不足確認    │
        │    - 必要に応じて追加            │
        └─────────────────────────────────┘
                          │
                          ▼
        ┌─────────────────────────────────┐
        │ 5. 整合性確認                    │
        │    - ドキュメント間の一貫性確認    │
        │    - 設定例の確認                │
        │    - セットアップ手順の確認      │
        └─────────────────────────────────┘
                          │
                          ▼
        ┌─────────────────────────────────┐
        │ 6. 最終確認                      │
        │    - SQLite記述が残っていないか  │
        │    - PostgreSQL記述が適切か     │
        │    - 矛盾や不整合がないか        │
        └─────────────────────────────────┘
```

### 2.2 検索パターン

#### 2.2.1 SQLite関連の検索パターン
以下のパターンでSQLite関連の記述を検索する：
- `SQLite`（大文字小文字を区別）
- `sqlite`（小文字）
- `SQLite3`（大文字小文字を区別）
- `sqlite3`（小文字）

**検索コマンド例**:
```bash
grep -ri "SQLite\|sqlite" README.md docs/
```

#### 2.2.2 検索対象外
以下のファイルは検索対象外とする：
- `.kiro/specs/` 内のファイル（履歴として残す）
- `cloudbeaver/config/` 内のファイル（ツールの設定）

### 2.3 修正方針

#### 2.3.1 SQLite関連記述の削除方針
以下の記述を削除する：
1. **説明文**: SQLiteに関する説明や紹介文
2. **設定例**: SQLiteを使用する設定例
3. **注意書き**: SQLiteに関する注意書きや制約事項
4. **比較表**: SQLiteを含む比較表の行
5. **手順**: SQLiteを使用するセットアップ手順

**削除時の注意事項**:
- 文脈を確認して、不要な記述のみを削除
- 段落全体を削除する場合は、前後の文脈が自然になるように調整
- 比較表から行を削除する場合は、表の構造を維持

#### 2.3.2 PostgreSQL関連記述の追加方針
SQLiteの記述を削除した箇所で、以下の条件を満たす場合はPostgreSQL関連の記述を追加する：

**追加条件**:
1. SQLiteの記述を削除した箇所に、PostgreSQL関連の記述がない
2. その箇所がデータベースに関する説明である
3. PostgreSQLの情報を追加することで、ドキュメントの理解が向上する

**追加内容**:
1. **接続情報**: PostgreSQLの接続情報（ホスト、ポート、ユーザー、パスワード、データベース名）
2. **設定例**: PostgreSQLを使用する設定例
3. **注意書き**: PostgreSQLに関する注意書きや制約事項
4. **説明文**: PostgreSQLに関する説明文

**追加時の注意事項**:
- 既存のPostgreSQL/MySQLに関する記述を参考にする
- ドキュメントの構造やフォーマットを維持する
- 一貫性を保つために、他のドキュメントの記述と整合させる

## 3. 対象ファイルの詳細設計

### 3.1 README.md

#### 3.1.1 確認項目
- プロジェクト概要でのデータベース記述
- セットアップ手順でのデータベース記述
- データベース接続情報の記述
- 機能説明でのデータベース記述

#### 3.1.2 修正方針
- SQLite関連の記述があれば削除
- データベースとしてPostgreSQL/MySQLが明確に記載されていることを確認
- 必要に応じてPostgreSQLの接続情報や設定例を追加

### 3.2 docs/Initial-Setup.md

#### 3.2.1 確認項目
- セットアップ手順でのデータベース記述
- インストール手順でのデータベース記述
- 設定手順でのデータベース記述

#### 3.2.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQLのセットアップ手順が明確に記載されていることを確認
- 必要に応じてPostgreSQLの設定例を追加

### 3.3 docs/Docker.md

#### 3.3.1 確認項目
- Dockerfileの説明でのデータベース記述
- docker-compose設定でのデータベース記述
- 環境変数でのデータベース記述

#### 3.3.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQLを使用するDocker設定が明確に記載されていることを確認
- 必要に応じてPostgreSQLの接続情報を追加

### 3.4 docs/API.md

#### 3.4.1 確認項目
- APIエンドポイントの説明でのデータベース記述
- データベース接続の説明

#### 3.4.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQLを使用するAPI設定が明確に記載されていることを確認

### 3.5 docs/Admin.md

#### 3.5.1 確認項目
- 管理画面の説明でのデータベース記述
- データベース接続の説明

#### 3.5.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQLを使用する管理画面設定が明確に記載されていることを確認

### 3.6 docs/Architecture.md

#### 3.6.1 確認項目
- アーキテクチャ図でのデータベース記述
- データベース設計の説明

#### 3.6.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQLを使用するアーキテクチャが明確に記載されていることを確認

### 3.7 docs/Atlas-Operations.md

#### 3.7.1 確認項目
- マイグレーション手順でのデータベース記述
- データベース接続の説明

#### 3.7.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQLを使用するマイグレーション手順が明確に記載されていることを確認

### 3.8 docs/Command-Line-Tool.md

#### 3.8.1 確認項目
- CLIツールの説明でのデータベース記述
- データベース接続の説明

#### 3.8.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQLを使用するCLIツール設定が明確に記載されていることを確認

### 3.9 docs/Database-Viewer.md

#### 3.9.1 確認項目
- データベースビューアの説明でのデータベース記述
- 接続設定の説明

#### 3.9.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQLを使用するデータベースビューア設定が明確に記載されていることを確認

### 3.10 docs/Generate-Sample-Data.md

#### 3.10.1 確認項目
- サンプルデータ生成の説明でのデータベース記述
- データベース接続の説明

#### 3.10.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQLを使用するサンプルデータ生成手順が明確に記載されていることを確認

### 3.11 その他のdocs/*.mdファイル

#### 3.11.1 確認項目
- 各ドキュメントでのデータベース記述
- 設定例でのデータベース記述

#### 3.11.2 修正方針
- SQLite関連の記述があれば削除
- PostgreSQL/MySQLに関する記述が適切であることを確認
- 必要に応じてPostgreSQL関連の記述を追加

## 4. 修正パターン設計

### 4.1 SQLite記述の削除パターン

#### 4.1.1 説明文の削除
```markdown
<!-- 削除前 -->
本プロジェクトではSQLite、PostgreSQL、MySQLをサポートしています。

<!-- 削除後 -->
本プロジェクトではPostgreSQL、MySQLをサポートしています。
```

#### 4.1.2 設定例の削除
```markdown
<!-- 削除前 -->
データベース設定例:
- SQLite: `sqlite3://database.db`
- PostgreSQL: `postgres://user:pass@localhost/dbname`

<!-- 削除後 -->
データベース設定例:
- PostgreSQL: `postgres://user:pass@localhost/dbname`
```

#### 4.1.3 比較表の行削除
```markdown
<!-- 削除前 -->
| データベース | 用途 |
|------------|------|
| SQLite | 開発環境 |
| PostgreSQL | 本番環境 |

<!-- 削除後 -->
| データベース | 用途 |
|------------|------|
| PostgreSQL | 本番環境 |
```

### 4.2 PostgreSQL記述の追加パターン

#### 4.2.1 接続情報の追加
```markdown
<!-- 追加前 -->
データベースに接続するには、設定ファイルを編集してください。

<!-- 追加後 -->
データベースに接続するには、設定ファイルを編集してください。

PostgreSQLの接続情報:
- ホスト: localhost
- ポート: 5432
- ユーザー: webdb
- パスワード: webdb
- データベース名: webdb_master
```

#### 4.2.2 設定例の追加
```markdown
<!-- 追加前 -->
データベース設定:

<!-- 追加後 -->
データベース設定:
```yaml
database:
  driver: postgres
  host: localhost
  port: 5432
  user: webdb
  password: webdb
  dbname: webdb_master
```
```

## 5. 整合性確認設計

### 5.1 ドキュメント間の一貫性確認

#### 5.1.1 データベース記述の一貫性
- すべてのドキュメントで、データベースとしてPostgreSQL/MySQLが記載されていることを確認
- SQLiteがデータベースオプションとして記載されていないことを確認

#### 5.1.2 設定例の一貫性
- 設定例でPostgreSQLが使用されていることを確認
- 設定例でSQLiteが使用されていないことを確認

#### 5.1.3 手順の一貫性
- セットアップ手順でPostgreSQLが使用されていることを確認
- セットアップ手順でSQLiteが使用されていないことを確認

### 5.2 最終確認項目

#### 5.2.1 SQLite記述の確認
- `README.md` にSQLite関連の記述が残っていない
- `docs/` ディレクトリ内のすべてのMarkdownファイルにSQLite関連の記述が残っていない
- プロジェクトルート直下のMarkdownファイルにSQLite関連の記述が残っていない

#### 5.2.2 PostgreSQL記述の確認
- データベースに関する説明で、PostgreSQLが明確に記載されている
- 設定例でPostgreSQLが使用されている
- セットアップ手順でPostgreSQLが使用されている

#### 5.2.3 整合性の確認
- すべてのドキュメントで、データベースとしてPostgreSQL/MySQLが記載されている
- SQLiteがデータベースオプションとして記載されていない
- ドキュメント間で記述が一貫している

## 6. 実装上の注意事項

### 6.1 検索と確認
- **網羅的な検索**: `grep` コマンドなどでSQLite関連の記述を網羅的に検索
- **文脈の確認**: 検索結果を確認し、文脈を理解してから削除
- **影響範囲の確認**: 削除による影響範囲を確認

### 6.2 削除と追加
- **段階的な修正**: 検索 → 確認 → 削除 → 追加の順序で作業
- **文脈の維持**: 削除後も文脈が自然になるように調整
- **一貫性の確保**: 追加する記述が他のドキュメントと一貫していることを確認

### 6.3 整合性確認
- **全体の確認**: すべてのドキュメントを読み直して整合性を確認
- **設定例の確認**: 設定例が正しいことを確認
- **手順の確認**: セットアップ手順が正しいことを確認

### 6.4 最終確認
- **再検索**: 修正後に再度SQLite関連の記述を検索して、残っていないことを確認
- **読み直し**: ドキュメントを読み直して、理解できることを確認
- **矛盾の確認**: 矛盾や不整合がないことを確認

## 7. 参考情報

### 7.1 関連Issue
- GitHub Issue #85: 開発環境はPostgreSQLを利用する前提とする
- GitHub Issue #91: ドキュメントの修正

### 7.2 既存ドキュメント
- `README.md`: プロジェクトの概要とセットアップ手順
- `docs/`: 機能別の詳細ドキュメント

### 7.3 技術スタック
- **データベース**: PostgreSQL/MySQL（全環境）
- **マイグレーションツール**: Atlas CLI
- **ドキュメント形式**: Markdown

### 7.4 参考リンク
- PostgreSQL公式ドキュメント: https://www.postgresql.org/docs/
- Atlas公式ドキュメント: https://atlasgo.io/
