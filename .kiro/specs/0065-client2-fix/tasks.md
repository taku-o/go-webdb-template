# client2アプリをclientに移行する実装タスク一覧

## 概要
client2アプリをclientに移行する実装を段階的に進めるためのタスク一覧。要件定義書と設計書に基づき、実装可能な粒度でタスクを分解。

## 実装フェーズ

### Phase 1: ディレクトリの移行

#### - [ ] タスク 1.1: client2アプリの事前動作確認
**目的**: 移行前にclient2アプリが正常に動作することを確認

**作業内容**:
- 開発サーバーが正常に起動することを確認
- 主要ページ（トップページ、ユーザー管理ページ、投稿管理ページなど）が正常に表示されることを確認
- 認証機能（ログイン、ログアウト）が正常に動作することを確認
- API呼び出しが正常に動作することを確認

**受け入れ基準**:
- 開発サーバーが正常に起動する
- 主要ページが正常に表示される
- 認証機能が正常に動作する
- API呼び出しが正常に動作する

_Requirements: 4.1, 6.5_

---

#### - [ ] タスク 1.2: 旧clientディレクトリの削除
**目的**: 不要になった既存の`client`ディレクトリを削除

**作業内容**:
- 旧`client/`ディレクトリ全体を削除
- Gitで管理されているため、履歴から復元可能であることを確認

**受け入れ基準**:
- 旧`client/`ディレクトリが削除されている
- Git履歴から復元可能であることが確認できる

_Requirements: 3.1.1, 6.1_

---

#### - [ ] タスク 1.3: client2ディレクトリのリネーム
**目的**: `client2`ディレクトリを`client`にリネーム

**作業内容**:
- `client2/`ディレクトリを`client/`にリネーム
- ファイルシステムレベルでのリネームを実行
- Gitで変更を追跡

**受け入れ基準**:
- `client2/`ディレクトリが`client/`にリネームされている
- Gitで変更が追跡されている

_Requirements: 3.1.2, 6.1_

---

#### - [ ] タスク 1.4: リネーム後の動作確認
**目的**: リネーム後の`client/`ディレクトリでアプリが正常に動作することを確認

**作業内容**:
- リネーム後の`client/`ディレクトリで開発サーバーが正常に起動することを確認
- 主要機能が正常に動作することを確認
- エラーが発生した場合は、ユーザーに状況を報告し、ロールバックの判断を待つ

**受け入れ基準**:
- リネーム後の`client/`ディレクトリで開発サーバーが正常に起動する
- 主要機能が正常に動作する
- エラー発生時はユーザーに報告し、ロールバックの判断を待つ

_Requirements: 6.1, 6.5_

---

### Phase 2: ドキュメントの更新

#### - [ ] タスク 2.1: README.mdの更新
**目的**: README.mdの`client`への言及を最新の状態に更新

**作業内容**:
- セットアップ手順の`cd client`セクションを確認・更新
- クライアント起動手順を確認・更新
- `client2`への言及があれば`client`に変更
- セットアップ手順が最新の実装と一致していることを確認

**受け入れ基準**:
- README.mdが更新されている
- `client`への言及が最新の状態になっている
- セットアップ手順が最新の実装と一致している

_Requirements: 3.2.1, 6.2_

---

#### - [ ] タスク 2.2: docs/Temp-Client2.mdの内容統合
**目的**: `docs/Temp-Client2.md`の内容を適切なドキュメントに統合

**作業内容**:
- `docs/Temp-Client2.md`の内容を確認
- セットアップ手順をREADME.mdに統合（既存のセットアップ手順と重複する場合は、より詳細な方を採用）
- 技術スタック、機能説明、ディレクトリ構造などの情報を適切なドキュメントに統合
- 既存のドキュメントと重複する内容は、より詳細で正確な方を採用

**受け入れ基準**:
- `docs/Temp-Client2.md`の内容が適切なドキュメントに統合されている
- セットアップ手順がREADME.mdに統合されている
- 技術スタック、機能説明、ディレクトリ構造などの情報が適切なドキュメントに統合されている

_Requirements: 3.2.2, 6.2_

---

#### - [ ] タスク 2.3: docs/Partner-Idp-Auth0-Login.mdの更新
**目的**: Auth0のコールバックURL設定をNextAuth対応に更新し、`client2`への言及を`client`に変更

**作業内容**:
- `client2`への言及があれば`client`に更新
- Auth0のコールバックURL設定を更新（`/auth/callback` → `/api/auth/callback/auth0`）
- セクション5.1「開発環境用のコールバックURL設定」のコールバックURLを`/api/auth/callback/auth0`に更新
- 各環境のURL一覧テーブルも同様に更新

**受け入れ基準**:
- `docs/Partner-Idp-Auth0-Login.md`が更新されている
- Auth0コールバックURL設定が更新されている（`/auth/callback` → `/api/auth/callback/auth0`）
- 各環境のURL一覧テーブルが更新されている

_Requirements: 3.2.3, 6.2_

---

#### - [ ] タスク 2.4: その他ドキュメントの更新
**目的**: その他ドキュメントファイルの`client2`や`client`への言及を確認・更新

**作業内容**:
- `docs/Project-Structure.md`の`client2`への言及があれば`client`に更新
- `docs/Testing.md`の`client2`への言及があれば`client`に更新
- `docs/Docker.md`の`client2`への言及があれば`client`に更新
- `docs/Release-Check.md`の`client2`への言及があれば`client`に更新
- `docs/API.md`の`client2`への言及があれば`client`に更新
- その他、`client2`や`client`への言及があるドキュメントを確認・更新
- すべてのドキュメントで`client`への言及が一貫していることを確認

**受け入れ基準**:
- その他ドキュメントで`client2`への言及が`client`に更新されている
- すべてのドキュメントで`client`への言及が一貫している

_Requirements: 3.2.3, 6.2_

---

#### - [ ] タスク 2.5: docs/Temp-Client2.mdの削除
**目的**: 移行完了後、一時的なドキュメントを削除

**作業内容**:
- 内容が適切なドキュメントに統合されていることを確認
- `docs/Temp-Client2.md`を削除

**受け入れ基準**:
- `docs/Temp-Client2.md`が削除されている
- 内容が適切なドキュメントに統合されていることが確認できる

_Requirements: 3.2.4, 6.2_

---

### Phase 3: 設定ファイルの更新

#### - [ ] タスク 3.1: docker-compose.client.ymlの確認・更新
**目的**: Docker Compose設定ファイルで`client`ディレクトリを参照するように更新

**作業内容**:
- `docker-compose.client.yml`の`context: ./client`が正しく設定されていることを確認
- その他、Docker Composeファイルで`client2`への参照があれば`client`に変更
- Docker Composeでコンテナが正常に起動することを確認

**受け入れ基準**:
- `docker-compose.client.yml`が更新され、`client`ディレクトリを参照している
- Docker Composeでコンテナが正常に起動する

_Requirements: 3.3.1, 6.3, 6.5_

---

#### - [ ] タスク 3.2: .gitignoreの確認・更新
**目的**: `.gitignore`で`client2`への参照を削除

**作業内容**:
- `.gitignore`で`client/`と`client2/`の両方が記載されている場合は、`client2/`を削除
- `client/`のエントリが適切に設定されていることを確認
- その他、設定ファイルで`client2`への参照を確認・更新

**受け入れ基準**:
- `.gitignore`が更新されている
- `client2/`への参照が削除されている
- `client/`のエントリが適切に設定されている

_Requirements: 3.3.2, 6.3_

---

### Phase 4: コード内の参照の確認

#### - [ ] タスク 4.1: コード内のclient2参照の検索
**目的**: コード内で`client2`への不適切な参照がないか確認

**作業内容**:
- `client/`ディレクトリ内のコードで`client2`への参照を検索
- 設定ファイル、コメント、ドキュメント内の`client2`への参照を確認
- 相対パスや絶対パスで`client2`を参照している箇所を確認

**受け入れ基準**:
- コード内の`client2`への参照がすべて検索されている
- 相対パスや絶対パスで`client2`を参照している箇所が特定されている

_Requirements: 3.4.1, 6.4_

---

#### - [ ] タスク 4.2: 参照の更新判断と修正
**目的**: 必要に応じてコード内の`client2`への参照を`client`に更新

**作業内容**:
- ディレクトリ名の変更のみで、コード内の参照は通常変更不要であることを確認
- ただし、相対パスや絶対パスで`client2`を参照している箇所があれば`client`に更新
- コード内に不適切な`client2`への参照がないことを確認

**受け入れ基準**:
- コード内に不適切な`client2`への参照がない
- 相対パスや絶対パスで`client2`を参照している箇所が`client`に更新されている

_Requirements: 3.4.1, 6.4_

---

#### - [ ] タスク 4.3: テストの実行と確認
**目的**: すべてのテストが正常に実行されることを確認

**作業内容**:
- E2Eテスト（Playwright）を実行し、すべてのテストが正常に実行されることを確認
- 統合テスト（Jest）を実行し、すべてのテストが正常に実行されることを確認
- 単体テスト（Jest）を実行し、すべてのテストが正常に実行されることを確認
- テストファイル内のパス参照を確認し、必要に応じて更新

**受け入れ基準**:
- E2Eテストが正常に実行される
- 統合テストが正常に実行される
- 単体テストが正常に実行される
- テストファイル内のパス参照が適切に更新されている

_Requirements: 6.4, 6.5_

---

### Phase 5: 最終確認と動作検証

#### - [ ] タスク 5.1: 開発サーバーの起動確認
**目的**: 移行後の開発サーバーが正常に起動することを確認

**作業内容**:
- `cd client && npm run dev`で開発サーバーが正常に起動することを確認

**受け入れ基準**:
- 開発サーバーが正常に起動する

_Requirements: 6.5_

---

#### - [ ] タスク 5.2: すべてのページの表示確認
**目的**: 移行後のすべてのページが正常に表示されることを確認

**作業内容**:
- トップページが正常に表示されることを確認
- ユーザー管理ページが正常に表示されることを確認
- 投稿管理ページが正常に表示されることを確認
- ユーザーと投稿のJOINページが正常に表示されることを確認
- メール送信ページが正常に表示されることを確認
- 動画アップロードページが正常に表示されることを確認
- ジョブキューページが正常に表示されることを確認

**受け入れ基準**:
- すべてのページが正常に表示される

_Requirements: 6.5_

---

#### - [ ] タスク 5.3: 認証機能の動作確認
**目的**: 移行後の認証機能が正常に動作することを確認

**作業内容**:
- ログイン機能が正常に動作することを確認
- ログアウト機能が正常に動作することを確認
- 認証トークンの取得が正常に動作することを確認
- プロフィール取得が正常に動作することを確認

**受け入れ基準**:
- 認証機能が正常に動作する

_Requirements: 6.5_

---

#### - [ ] タスク 5.4: API呼び出しの動作確認
**目的**: 移行後のAPI呼び出しが正常に動作することを確認

**作業内容**:
- すべてのAPIエンドポイントが正常に動作することを確認
- 認証が必要なAPI呼び出しで適切にトークンが使用されることを確認

**受け入れ基準**:
- API呼び出しが正常に動作する

_Requirements: 6.5_

---

#### - [ ] タスク 5.5: Docker環境での動作確認
**目的**: Docker環境でクライアントアプリが正常に動作することを確認

**作業内容**:
- `docker-compose -f docker-compose.client.yml up -d`でコンテナが正常に起動することを確認
- Docker環境でクライアントアプリが正常に動作することを確認

**受け入れ基準**:
- Docker環境でコンテナが正常に起動する
- Docker環境でクライアントアプリが正常に動作する

_Requirements: 6.5_

---

## 実装順序の推奨

1. **Phase 1**: ディレクトリの移行（削除・リネーム）
2. **Phase 2**: ドキュメントの更新（README.md、その他ドキュメント、Temp-Client2.mdの統合・削除）
3. **Phase 3**: 設定ファイルの更新（Docker Compose、.gitignoreなど）
4. **Phase 4**: コード内の参照の確認（テスト、その他コード）
5. **Phase 5**: 最終確認と動作検証

## 注意事項

- **Phase 1の事前確認**: 移行前に必ずclient2アプリが正常に動作することを確認すること
- **エラー発生時の対応**: エラーが発生した場合、自動的にロールバックを実行せず、ユーザーに状況を報告し、ロールバックの判断を待つこと
- **Auth0コールバックURL設定**: `docs/Partner-Idp-Auth0-Login.md`のコールバックURL設定を必ず更新すること（`/auth/callback` → `/api/auth/callback/auth0`）
- **ドキュメントの整合性**: すべてのドキュメントで`client`への言及が一貫していることを確認すること
- **Git履歴**: 旧`client`ディレクトリの履歴はGitで管理されているため、必要に応じて履歴から復元可能
