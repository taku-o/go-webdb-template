server:
  port: 8080
  read_timeout: 30s
  write_timeout: 30s

database:
  shards:
    - id: 1
      driver: postgres
      host: prod-db-shard1.example.com
      port: 5432
      name: app_db_shard1
      user: prod_user
      password: ${DB_PASSWORD_SHARD1}  # 環境変数から読み込み
      writer_dsn: host=prod-db-shard1-writer.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD1} dbname=app_db_shard1 sslmode=require
      reader_dsns:
        - host=prod-db-shard1-reader1.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD1} dbname=app_db_shard1 sslmode=require
        - host=prod-db-shard1-reader2.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD1} dbname=app_db_shard1 sslmode=require
      reader_policy: round_robin
      max_connections: 50
      max_idle_connections: 20
      connection_max_lifetime: 600s
    - id: 2
      driver: postgres
      host: prod-db-shard2.example.com
      port: 5432
      name: app_db_shard2
      user: prod_user
      password: ${DB_PASSWORD_SHARD2}  # 環境変数から読み込み
      writer_dsn: host=prod-db-shard2-writer.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD2} dbname=app_db_shard2 sslmode=require
      reader_dsns:
        - host=prod-db-shard2-reader1.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD2} dbname=app_db_shard2 sslmode=require
        - host=prod-db-shard2-reader2.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD2} dbname=app_db_shard2 sslmode=require
      reader_policy: round_robin
      max_connections: 50
      max_idle_connections: 20
      connection_max_lifetime: 600s

logging:
  level: warn
  format: json
  output: /var/log/app/server.log

cors:
  allowed_origins:
    - https://example.com
  allowed_methods:
    - GET
    - POST
    - PUT
    - DELETE
    - OPTIONS
  allowed_headers:
    - Content-Type
    - Authorization
