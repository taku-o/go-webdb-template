database:
  shards:
    - id: 1
      driver: postgres
      host: prod-db-shard1.example.com
      port: 5432
      name: app_db_shard1
      user: prod_user
      password: ${DB_PASSWORD_SHARD1}  # 環境変数から読み込み
      writer_dsn: host=prod-db-shard1-writer.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD1} dbname=app_db_shard1 sslmode=require
      reader_dsns:
        - host=prod-db-shard1-reader1.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD1} dbname=app_db_shard1 sslmode=require
        - host=prod-db-shard1-reader2.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD1} dbname=app_db_shard1 sslmode=require
      reader_policy: round_robin
      max_connections: 50
      max_idle_connections: 20
      connection_max_lifetime: 600s
    - id: 2
      driver: postgres
      host: prod-db-shard2.example.com
      port: 5432
      name: app_db_shard2
      user: prod_user
      password: ${DB_PASSWORD_SHARD2}  # 環境変数から読み込み
      writer_dsn: host=prod-db-shard2-writer.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD2} dbname=app_db_shard2 sslmode=require
      reader_dsns:
        - host=prod-db-shard2-reader1.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD2} dbname=app_db_shard2 sslmode=require
        - host=prod-db-shard2-reader2.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD2} dbname=app_db_shard2 sslmode=require
      reader_policy: round_robin
      max_connections: 50
      max_idle_connections: 20
      connection_max_lifetime: 600s
    - id: 3
      driver: postgres
      host: prod-db-shard3.example.com
      port: 5432
      name: app_db_shard3
      user: prod_user
      password: ${DB_PASSWORD_SHARD3}  # 環境変数から読み込み
      writer_dsn: host=prod-db-shard3-writer.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD3} dbname=app_db_shard3 sslmode=require
      reader_dsns:
        - host=prod-db-shard3-reader1.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD3} dbname=app_db_shard3 sslmode=require
        - host=prod-db-shard3-reader2.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD3} dbname=app_db_shard3 sslmode=require
      reader_policy: round_robin
      max_connections: 50
      max_idle_connections: 20
      connection_max_lifetime: 600s
    - id: 4
      driver: postgres
      host: prod-db-shard4.example.com
      port: 5432
      name: app_db_shard4
      user: prod_user
      password: ${DB_PASSWORD_SHARD4}  # 環境変数から読み込み
      writer_dsn: host=prod-db-shard4-writer.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD4} dbname=app_db_shard4 sslmode=require
      reader_dsns:
        - host=prod-db-shard4-reader1.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD4} dbname=app_db_shard4 sslmode=require
        - host=prod-db-shard4-reader2.example.com port=5432 user=prod_user password=${DB_PASSWORD_SHARD4} dbname=app_db_shard4 sslmode=require
      reader_policy: round_robin
      max_connections: 50
      max_idle_connections: 20
      connection_max_lifetime: 600s
